<view class="page-container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <text class="header-title">å¾…åŠäº‹é¡¹</text>
    <view class="add-btn" bindtap="showAddModal">
      <text class="iconfont icon-add">+</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:elif="{{schedules.length === 0}}">
    <text class="empty-state-icon">ğŸ“</text>
    <text class="empty-state-text">æš‚æ— å¾…åŠäº‹é¡¹</text>
  </view>

  <!-- å¾…åŠäº‹é¡¹åˆ—è¡¨ -->
  <view class="schedule-list" wx:else>
    <view 
      class="schedule-card {{item.priority}}"
      wx:for="{{schedules}}"
      wx:key="id"
    >
      <view class="schedule-header">
        <text class="schedule-title">{{item.title}}</text>
        <view class="schedule-actions">
          <view 
            class="action-btn"
            bindtap="showEditModal"
            data-schedule="{{item}}"
          >
            <text class="iconfont icon-edit">âœï¸</text>
          </view>
          <view 
            class="action-btn"
            bindtap="deleteSchedule"
            data-id="{{item.id}}"
          >
            <text class="iconfont icon-delete">ğŸ—‘ï¸</text>
          </view>
        </view>
      </view>

      <view class="schedule-content">{{item.content}}</view>

      <view class="schedule-footer">
        <view class="schedule-meta">
          <text>{{item.startTime}}</text>
          <text wx:if="{{item.endTime}}">- {{item.endTime}}</text>
        </view>
        <view class="schedule-tags">
          <text class="priority-tag priority-{{item.priority}}">
            {{item.priority === 'high' ? 'é«˜ä¼˜å…ˆçº§' : item.priority === 'medium' ? 'ä¸­ä¼˜å…ˆçº§' : 'ä½ä¼˜å…ˆçº§'}}
          </text>
          <text 
            class="tag"
            wx:for="{{item.tags.split(',')}}"
            wx:key="*this"
            wx:if="{{item}}"
          >{{item}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ·»åŠ /ç¼–è¾‘æ¨¡æ€æ¡† -->
  <view class="modal" wx:if="{{showAddModal || showEditModal}}">
    <view class="modal-content">
      <view class="modal-form">
        <view class="form-group">
          <text class="form-label">æ ‡é¢˜</text>
          <input 
            class="form-input"
            type="text"
            placeholder="è¯·è¾“å…¥æ ‡é¢˜"
            value="{{formData.title}}"
            bindinput="handleInput"
            data-field="title"
          />
        </view>

        <view class="form-group">
          <text class="form-label">å†…å®¹</text>
          <textarea 
            class="form-input"
            placeholder="è¯·è¾“å…¥å†…å®¹"
            value="{{formData.content}}"
            bindinput="handleInput"
            data-field="content"
          />
        </view>

        <view class="form-group">
          <text class="form-label">å¼€å§‹æ—¶é—´</text>
          <picker 
            class="date-picker"
            mode="date"
            value="{{formData.startTime}}"
            bindchange="handleInput"
            data-field="startTime"
          >
            <view>{{formData.startTime || 'è¯·é€‰æ‹©å¼€å§‹æ—¶é—´'}}</view>
          </picker>
        </view>

        <view class="form-group">
          <text class="form-label">ç»“æŸæ—¶é—´</text>
          <picker 
            class="date-picker"
            mode="date"
            value="{{formData.endTime}}"
            bindchange="handleInput"
            data-field="endTime"
          >
            <view>{{formData.endTime || 'è¯·é€‰æ‹©ç»“æŸæ—¶é—´'}}</view>
          </picker>
        </view>

        <view class="form-group">
          <text class="form-label">ä¼˜å…ˆçº§</text>
          <picker 
            class="picker"
            mode="selector"
            range="{{['é«˜ä¼˜å…ˆçº§', 'ä¸­ä¼˜å…ˆçº§', 'ä½ä¼˜å…ˆçº§']}}"
            value="{{formData.priority === 'high' ? 0 : formData.priority === 'medium' ? 1 : 2}}"
            bindchange="handlePriorityChange"
          >
            <view>{{formData.priority === 'high' ? 'é«˜ä¼˜å…ˆçº§' : formData.priority === 'medium' ? 'ä¸­ä¼˜å…ˆçº§' : 'ä½ä¼˜å…ˆçº§'}}</view>
          </picker>
        </view>

        <view class="form-group">
          <text class="form-label">æ ‡ç­¾</text>
          <input 
            class="form-input"
            type="text"
            placeholder="è¯·è¾“å…¥æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš”"
            value="{{formData.tags}}"
            bindinput="handleInput"
            data-field="tags"
          />
        </view>

        <view class="form-actions">
          <button 
            class="btn btn-secondary"
            bindtap="{{showAddModal ? 'hideAddModal' : 'hideEditModal'}}"
          >å–æ¶ˆ</button>
          <button 
            class="btn btn-primary"
            bindtap="handleSubmit"
          >ä¿å­˜</button>
        </view>
      </view>
    </view>
  </view>
</view> 